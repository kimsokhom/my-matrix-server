# --- HOMESERVER CONFIGURATION ---
homeserver:
  address: http://synapse.railway.internal:8008
  domain: ${SERVER_NAME}

# --- APPSERVICE CONFIGURATION ---
appservice:
  address: http://mautrix-telegram.railway.internal:29317
  hostname: 0.0.0.0
  port: 29317
  database: postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/railway

  # Identity & Security
  id: telegram
  as_token: ${TELEGRAM_AS_TOKEN}
  hs_token: ${TELEGRAM_HS_TOKEN}

# --- TELEGRAM API CONFIGURATION ---
telegram:
  api_id: ${TELEGRAM_API_ID}
  api_hash: ${TELEGRAM_API_HASH}

# --- BRIDGE SETTINGS ---
bridge:
  permissions:
    "${SERVER_NAME}": "full"
    "@admin_1:${SERVER_NAME}": "admin"

  # History & Backfill
  backfill:
    enabled: false
    initial_limit: 0
    missed_limit: 0
    disable_notifications: true

  # DISABLED: Puppet & Syncing Settings (causes Telegram bans)
  sync_with_custom_puppets: false
  double_puppet_allow_discovery: false
  double_puppet_server_map: {}

  # DISABLED: Authentication (related to puppeting)
  allow_matrix_login: true
  login_shared_secret_map:
    ${SERVER_NAME}: "${REGISTRATION_SHARED_SECRET}"

  # Encryption & Device Management
  force_unverified_device: true
  device_name: "Telegram Bridge"

# --- LOGGING CONFIGURATION ---
logging:
  version: 1
  formatters:
    precise:
      format: "[%(asctime)s] [%(levelname)s@%(name)s] %(message)s"
  handlers:
    console:
      class: logging.StreamHandler
      formatter: precise
      stream: ext://sys.stdout
  loggers:
    mau:
      level: INFO
    telethon:
      level: INFO
  root:
    level: INFO
    handlers: [console]
